# YSZ 프로젝트 개발 로드맵 (2025)

## 프로젝트 현황 (2025-11-22 기준)

### ✅ 완료된 항목 (Phase 1 & 2)

- **Phase 1: 핵심 계산 엔진** (100% 완료)
  - [x] TaxCalculator: 양도소득세 계산 로직
  - [x] RuleEngine: 세법 규칙 관리 (YAML 기반)
  - [x] Fact/FactLedger: 불변 데이터 구조
  - [x] CalculationTrace: 계산 과정 추적

- **Phase 2: AI 에이전트 시스템** (100% 완료)
  - [x] BaseAgent & AgentProtocol
  - [x] RuleVersion & RuleRegistry
  - [x] StrategyAgent (케이스 분류, 시나리오 생성, 리스크 분석)
  - [x] Claude 3.5 Sonnet 통합
  - [x] 17+8 테스트, 7 예제, 4 문서

- **백엔드 API** (80% 완료)
  - [x] FastAPI 기반 REST API
  - [x] /api/v1/facts - 사실관계 수집/확인
  - [x] /api/v1/calculate - 세금 계산
  - [ ] /api/v1/chat - 대화형 상담 (예정)

- **프론트엔드** (60% 완료)
  - [x] 4단계 마법사 UI (React + Ant Design)
  - [x] 데이터 입력 폼
  - [x] 사실관계 확인 페이지
  - [x] 계산 진행 표시
  - [x] 결과 표시 페이지
  - [ ] 채팅 인터페이스 (예정)

---

## 🎯 다음 개발 방향

### 우선순위 1: 대화형 AI 인터페이스 (ChatAgent)

**목표**: 사용자가 자연어로 양도소득세 상담을 받을 수 있는 챗봇 구현

**구현 항목**:

#### 1.1 백엔드 - ChatAgent 구현
- [ ] ChatAgent 클래스 구현 (`src/agents/chat_agent.py`)
  - [ ] 의도 파악 (Intent Classification)
  - [ ] 일반 질문 처리 (세법 설명)
  - [ ] 계산 요청 처리 (TaxCalculator 연동)
  - [ ] 전략 상담 처리 (StrategyAgent 연동)
  - [ ] 대화 컨텍스트 관리
- [ ] ChatContext 데이터 모델
- [ ] ChatMessage 데이터 모델
- [ ] LLM 응답 생성 (Claude 3.5 Sonnet)

**예상 소요 시간**: 3-4일

#### 1.2 백엔드 - Chat API 엔드포인트
- [ ] `/api/v1/chat/message` - 메시지 전송/응답
- [ ] `/api/v1/chat/history/{session_id}` - 대화 이력 조회
- [ ] `/api/v1/chat/session/{session_id}` - 세션 관리
- [ ] Request/Response 스키마 정의
- [ ] 에러 처리

**예상 소요 시간**: 1-2일

#### 1.3 프론트엔드 - ChatComponent 구현
- [ ] ChatComponent.tsx 구현
  - [ ] 메시지 리스트 UI
  - [ ] 입력창 및 전송 버튼
  - [ ] 로딩 상태 표시
  - [ ] 메타데이터 표시 (세액, 시나리오 등)
- [ ] App.tsx에 통합
- [ ] 세션 ID 관리
- [ ] 기존 거래와 연동

**예상 소요 시간**: 2-3일

#### 1.4 테스트 및 문서화
- [ ] ChatAgent 단위 테스트
- [ ] API 통합 테스트
- [ ] E2E 테스트 (프론트엔드 포함)
- [ ] 사용자 가이드 작성
- [ ] API 문서 업데이트

**예상 소요 시간**: 1-2일

**총 예상 소요 시간**: 7-11일 (약 1.5-2주)

**완료 기준**:
- ✅ 사용자가 자연어로 질문하면 AI가 답변
- ✅ 계산 요청 시 TaxCalculator 실행 및 결과 설명
- ✅ 전략 상담 시 StrategyAgent 실행 및 시나리오 제시
- ✅ 대화 이력 저장 및 조회

---

### 우선순위 2: OrchestratorAgent 강화

**목표**: 여러 에이전트를 조율하는 총괄 에이전트 고도화

**구현 항목**:

#### 2.1 Orchestrator 리팩토링
- [ ] 기존 OrchestratorAgent 분석
- [ ] StrategyAgent 통합
- [ ] ChatAgent 통합
- [ ] Agent 간 데이터 전달 표준화
- [ ] 워크플로우 최적화

**예상 소요 시간**: 2-3일

#### 2.2 계획-검증-실행 패턴 구현
- [ ] AgentPlan 데이터 클래스 (이미 구현됨)
- [ ] Plan Validation 로직
- [ ] Execution Trace 강화
- [ ] Rollback 메커니즘

**예상 소요 시간**: 2-3일

**총 예상 소요 시간**: 4-6일 (약 1주)

---

### 우선순위 3: VerificationAgent 구현

**목표**: 계산 결과 및 전략을 검증하는 에이전트

**구현 항목**:

#### 3.1 VerificationAgent 클래스
- [ ] 로직 검증 (StrategyAgent 결과 검증)
- [ ] 세법 버전 체크 (최신 규칙 적용 확인)
- [ ] 착오류 체크 (통계 기반)
- [ ] 리스크 플래그 생성
- [ ] 유사 사례 비교

**예상 소요 시간**: 3-4일

#### 3.2 검증 규칙 데이터베이스
- [ ] 착오류 통계 DB
- [ ] 유사 사례 DB
- [ ] 세법 변경 이력

**예상 소요 시간**: 2-3일

**총 예상 소요 시간**: 5-7일 (약 1-1.5주)

---

### 우선순위 4: 정보 수집 강화 (AssetCollectorAgent)

**목표**: 다양한 소스에서 정보를 자동으로 수집

**구현 항목**:

#### 4.1 OCR 통합
- [ ] Tesseract OCR 통합
- [ ] Google Cloud Vision API 통합 (선택)
- [ ] 문서 유형별 파싱 로직
  - [ ] 부동산 등기부등본
  - [ ] 매매계약서
  - [ ] 취득세 납부 영수증

**예상 소요 시간**: 4-5일

#### 4.2 외부 API 연동
- [ ] 국토부 실거래가 API
- [ ] 행안부 주소 API
- [ ] 금융결제원 부동산 거래 내역

**예상 소요 시간**: 2-3일

#### 4.3 자연어 처리
- [ ] 사용자 메시지에서 사실관계 추출 (LLM)
- [ ] 애매한 정보 확인 질문 생성
- [ ] 자동 정규화

**예상 소요 시간**: 2-3일

**총 예상 소요 시간**: 8-11일 (약 1.5-2주)

---

### 우선순위 5: 신고서 작성 자동화 (FilingAgent)

**목표**: 양도소득세 예정신고서 자동 작성

**구현 항목**:

#### 5.1 신고서 양식 구현
- [ ] 양도소득세 예정신고서 (양식 작성)
- [ ] PDF 생성 (reportlab 또는 WeasyPrint)
- [ ] 필드 자동 채우기

**예상 소요 시간**: 3-4일

#### 5.2 납부 안내
- [ ] 신고 기한 자동 계산
- [ ] 납부 방법 안내
- [ ] 분할 납부 시뮬레이션

**예상 소요 시간**: 1-2일

#### 5.3 필요 서류 체크리스트
- [ ] 케이스별 필수 서류 목록
- [ ] 서류 업로드 UI
- [ ] 서류 검증

**예상 소요 시간**: 2-3일

**총 예상 소요 시간**: 6-9일 (약 1-1.5주)

---

## 📅 개발 일정 (제안)

### Q1 2025 (1-3월)

| 주차 | 작업 항목 | 담당 | 상태 |
|-----|---------|------|------|
| Week 1-2 | **ChatAgent 백엔드 구현** | Backend Dev | 🟡 예정 |
| Week 3 | **ChatComponent 프론트엔드 구현** | Frontend Dev | 🟡 예정 |
| Week 4 | **ChatAgent 테스트 & 통합** | QA | 🟡 예정 |
| Week 5 | **OrchestratorAgent 강화** | Backend Dev | 🟡 예정 |
| Week 6-7 | **VerificationAgent 구현** | Backend Dev | 🟡 예정 |
| Week 8 | **Phase 2.5 통합 테스트** | QA | 🟡 예정 |

**마일스톤**: Phase 2.5 완료 (Orchestrator & Verification)

### Q2 2025 (4-6월)

| 주차 | 작업 항목 | 담당 | 상태 |
|-----|---------|------|------|
| Week 9-10 | **AssetCollectorAgent OCR 통합** | Backend Dev | 🟡 예정 |
| Week 11 | **외부 API 연동** | Backend Dev | 🟡 예정 |
| Week 12-13 | **FilingAgent 신고서 작성** | Backend Dev | 🟡 예정 |
| Week 14 | **프론트엔드 UI/UX 개선** | Frontend Dev | 🟡 예정 |
| Week 15-16 | **Phase 3 통합 테스트** | QA | 🟡 예정 |

**마일스톤**: Phase 3 완료 (정보 수집 & 신고)

### Q3 2025 (7-9월)

| 항목 | 내용 |
|-----|------|
| **베타 테스트** | 세무법인과 협업하여 실제 케이스 테스트 |
| **피드백 반영** | UI/UX 개선, 버그 수정 |
| **성능 최적화** | 응답 속도 개선, 캐싱 전략 |
| **보안 강화** | 개인정보 보호, 접근 제어 |

### Q4 2025 (10-12월)

| 항목 | 내용 |
|-----|------|
| **정식 출시** | v1.0 릴리스 |
| **마케팅** | 세무법인 대상 영업 |
| **모니터링** | 사용 통계 수집 및 분석 |
| **유지보수** | 버그 수정 및 세법 변경 대응 |

---

## 🛠️ 기술적 개선 사항

### 1. 성능 최적화

#### 1.1 캐싱 전략
- [ ] Redis 도입
  - [ ] 계산 결과 캐싱 (동일 입력 → 즉시 반환)
  - [ ] 세법 규칙 캐싱
  - [ ] 대화 컨텍스트 저장
- [ ] CDN 활용 (프론트엔드 정적 파일)

**예상 효과**: 응답 시간 50-70% 단축

#### 1.2 데이터베이스 최적화
- [ ] PostgreSQL 인덱스 최적화
- [ ] 쿼리 최적화 (N+1 문제 해결)
- [ ] 읽기 전용 복제본 (Read Replica)

**예상 효과**: DB 쿼리 속도 30-50% 향상

#### 1.3 비동기 처리
- [ ] Celery 도입 (장기 실행 작업)
- [ ] WebSocket 스트리밍 (ChatAgent)
- [ ] 백그라운드 작업 큐

**예상 효과**: 사용자 체감 속도 대폭 개선

---

### 2. 확장성

#### 2.1 마이크로서비스화 (선택)
```
현재: 모놀리식
┌─────────────────────┐
│   FastAPI App       │
│  ┌───────┐ ┌──────┐ │
│  │ Agents│ │ Core │ │
│  └───────┘ └──────┘ │
└─────────────────────┘

향후: 마이크로서비스
┌────────────┐  ┌────────────┐  ┌────────────┐
│ Chat       │  │ Calculation│  │ Strategy   │
│ Service    │  │ Service    │  │ Service    │
└────────────┘  └────────────┘  └────────────┘
       │               │               │
       └───────────────┴───────────────┘
                       │
                 ┌─────────────┐
                 │ API Gateway │
                 └─────────────┘
```

**시기**: 사용자 1만명 이상 시 고려

#### 2.2 컨테이너화 & 오케스트레이션
- [ ] Docker Compose → Kubernetes
- [ ] Auto Scaling 설정
- [ ] Health Check & Self-healing

---

### 3. 보안 강화

#### 3.1 인증/인가
- [ ] JWT 기반 인증
- [ ] OAuth 2.0 (Google, Naver 로그인)
- [ ] 역할 기반 접근 제어 (RBAC)

#### 3.2 데이터 보호
- [ ] 개인정보 암호화 (AES-256)
- [ ] HTTPS 강제
- [ ] SQL Injection 방지
- [ ] XSS/CSRF 방어

#### 3.3 감사 로그
- [ ] 모든 계산 기록 저장
- [ ] 사용자 행동 추적
- [ ] 이상 탐지 시스템

---

### 4. 모니터링 & 관찰성

#### 4.1 로깅
- [ ] 구조화된 로깅 (JSON 형식)
- [ ] ELK Stack (Elasticsearch, Logstash, Kibana)
- [ ] 에러 추적 (Sentry)

#### 4.2 메트릭
- [ ] Prometheus + Grafana
- [ ] API 응답 시간 모니터링
- [ ] Agent 실행 시간 추적
- [ ] 성공률/실패율 대시보드

#### 4.3 알림
- [ ] Slack/Email 알림 (장애 발생 시)
- [ ] On-call 체계 구축

---

## 🎨 UI/UX 개선

### 1. 시각화 강화

- [ ] 세금 계산 프로세스 시각화
  - [ ] 플로우차트 애니메이션
  - [ ] 단계별 진행 표시
- [ ] 차트 및 그래프
  - [ ] 세액 구성 비율 (파이 차트)
  - [ ] 보유 기간별 세액 변화 (라인 차트)
  - [ ] 시나리오 비교 (막대 차트)
- [ ] 인포그래픽
  - [ ] 비과세 요건 체크리스트
  - [ ] 절세 팁

**사용 라이브러리**: recharts (이미 설치됨)

---

### 2. 반응형 디자인

- [ ] 모바일 최적화
- [ ] 태블릿 레이아웃
- [ ] 다크 모드 지원

---

### 3. 접근성 (A11y)

- [ ] 스크린 리더 지원
- [ ] 키보드 내비게이션
- [ ] 고대비 모드
- [ ] WCAG 2.1 AA 준수

---

## 📊 비즈니스 로직 확장

### 1. 다양한 자산 유형 지원

현재: 부동산 (주택, 상업용, 토지)
향후:
- [ ] 주식 (상장/비상장)
- [ ] 가상자산 (암호화폐)
- [ ] 부동산 외 자산 (골프회원권, 부동산 외 자산)

---

### 2. 세법 업데이트 자동화

- [ ] 국세청 공지사항 크롤링
- [ ] 세법 개정 알림
- [ ] YAML 규칙 자동 업데이트 (반자동)

---

### 3. 세무사 협업 기능

- [ ] 세무사 대시보드
  - [ ] 고객 케이스 관리
  - [ ] 일괄 계산
  - [ ] 통계 및 리포트
- [ ] 고객-세무사 매칭
- [ ] 수수료 계산

---

## 🧪 테스트 전략

### 1. 단위 테스트 (Unit Test)
- **목표**: 커버리지 90% 이상
- **도구**: pytest
- **대상**: 모든 Agent, Calculator, RuleEngine

### 2. 통합 테스트 (Integration Test)
- **목표**: Agent 간 상호작용 검증
- **도구**: pytest + pytest-asyncio
- **대상**: Orchestrator, API 엔드포인트

### 3. E2E 테스트 (End-to-End)
- **목표**: 사용자 시나리오 전체 검증
- **도구**: Playwright (프론트엔드)
- **대상**: 4단계 마법사 + 채팅

### 4. 성능 테스트 (Load Test)
- **목표**: 동시 접속 100명 처리
- **도구**: Locust, k6
- **대상**: API 엔드포인트

---

## 💰 비용 추정 (월간)

| 항목 | 비용 (USD) | 비고 |
|-----|-----------|------|
| **클라우드 (AWS/GCP)** | $100-300 | EC2, RDS, S3 |
| **Claude API** | $50-200 | 사용량에 따라 변동 |
| **기타 API** | $20-50 | OCR, 외부 API |
| **모니터링** | $0-50 | Sentry, Datadog (선택) |
| **총계** | **$170-600** | 초기 단계 기준 |

**스케일링 시** (사용자 1만명):
- 클라우드: $500-1000
- Claude API: $300-800
- 총계: **$800-2000/월**

---

## 📝 문서화

### 1. 기술 문서
- [x] 아키텍처 문서
- [x] API 문서 (Swagger/OpenAPI)
- [x] Agent 명세서
- [ ] 배포 가이드
- [ ] 트러블슈팅 가이드

### 2. 사용자 문서
- [ ] 사용자 매뉴얼
- [ ] FAQ
- [ ] 튜토리얼 비디오

### 3. 개발자 문서
- [ ] 컨트리뷰션 가이드
- [ ] 코드 스타일 가이드
- [ ] 새 Agent 추가 가이드

---

## 🚀 요약: 즉시 시작할 수 있는 작업

### 추천 순서

1. **ChatAgent 구현** (최우선, 1.5-2주)
   - 사용자가 즉시 체감할 수 있는 가치
   - StrategyAgent와 시너지

2. **OrchestratorAgent 강화** (1주)
   - 전체 시스템 통합
   - Agent 간 협업 최적화

3. **VerificationAgent 구현** (1-1.5주)
   - 신뢰성 향상
   - 세무 당국 감사 대비

4. **AssetCollectorAgent OCR** (1.5-2주)
   - 사용자 편의성 대폭 향상
   - 입력 오류 감소

5. **FilingAgent 신고서** (1-1.5주)
   - 완전한 End-to-End 솔루션
   - 세무사 협업 가능

**총 예상 기간**: 6-8주 (약 1.5-2개월)

---

## 결론

YSZ 프로젝트는 **Phase 2 완료**로 탄탄한 기반을 확보했습니다.

**다음 단계**:
1. 🎯 **ChatAgent로 사용자 경험 극대화**
2. 🔧 **Orchestrator & Verification으로 안정성 확보**
3. 📸 **OCR & 자동화로 편의성 향상**
4. 📄 **신고서 작성으로 완전한 솔루션 제공**

**핵심 철학 유지**:
- ✅ 계산은 코드가 (결정론적)
- ✅ 설명은 LLM이 (친화적)
- ✅ 모든 판단은 추적 가능 (감사 대응)

---

**문서 버전**: v1.0
**작성일**: 2025-11-22
**다음 리뷰**: Phase 2.5 완료 후 (2025년 3월 예상)
