<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì–‘ìƒì¦ë‹·ì»´ - ì–‘ë„ì†Œë“ì„¸ ìë™ ê³„ì‚° (ë°ëª¨)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .result-box {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 2em;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .result-value.tax-free {
            color: #10b981;
        }

        .result-value.taxable {
            color: #ef4444;
        }

        .scenario {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .scenario h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .pros, .cons {
            font-size: 0.9em;
        }

        .pros li {
            color: #10b981;
        }

        .cons li {
            color: #ef4444;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-right: 10px;
        }

        .badge.recommended {
            background: #10b981;
            color: white;
        }

        .badge.info {
            background: #3b82f6;
            color: white;
        }

        .risk-item {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 3px solid #ffc107;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.8em;
            }

            .pros-cons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ  ì–‘ìƒì¦ë‹·ì»´</h1>
            <p class="subtitle">ì–‘ë„ì†Œë“ì„¸ ìë™ ê³„ì‚° ì‹œìŠ¤í…œ (Phase 2 ë°ëª¨)</p>
            <p style="margin-top: 10px; color: #999; font-size: 0.9em;">
                âœ… StrategyAgent 100% êµ¬í˜„ ì™„ë£Œ | ğŸ’¯ 100% ê²°ì •ë¡ ì  ë¡œì§
            </p>
        </header>

        <div class="main-content">
            <!-- ì…ë ¥ í¼ -->
            <div class="card">
                <h2>ğŸ“ ì‚¬ì‹¤ê´€ê³„ ì…ë ¥</h2>
                <form id="taxForm">
                    <div class="form-group">
                        <label>ì·¨ë“ì¼</label>
                        <input type="date" id="acquisitionDate" value="2020-01-01" required>
                    </div>

                    <div class="form-group">
                        <label>ì·¨ë“ê°€ì•¡ (ì›)</label>
                        <input type="number" id="acquisitionPrice" value="500000000" required>
                    </div>

                    <div class="form-group">
                        <label>ì–‘ë„ì¼</label>
                        <input type="date" id="disposalDate" value="2024-11-21" required>
                    </div>

                    <div class="form-group">
                        <label>ì–‘ë„ê°€ì•¡ (ì›)</label>
                        <input type="number" id="disposalPrice" value="800000000" required>
                    </div>

                    <div class="form-group">
                        <label>ì£¼íƒ ìˆ˜ (ì±„)</label>
                        <input type="number" id="houseCount" value="1" min="1" required>
                    </div>

                    <div class="form-group">
                        <label>ê±°ì£¼ ê¸°ê°„ (ë…„)</label>
                        <input type="number" id="residenceYears" value="4" min="0" required>
                    </div>

                    <div class="form-group">
                        <label>ì¡°ì •ëŒ€ìƒì§€ì—­</label>
                        <select id="adjustedArea">
                            <option value="false">ì•„ë‹ˆì˜¤</option>
                            <option value="true">ì˜ˆ</option>
                        </select>
                    </div>

                    <button type="submit">ğŸš€ ì „ëµ ë¶„ì„ ì‹œì‘</button>
                </form>
            </div>

            <!-- ê²°ê³¼ í‘œì‹œ -->
            <div class="card">
                <h2>ğŸ“Š ë¶„ì„ ê²°ê³¼</h2>
                <div id="results" class="hidden">
                    <div class="result-box">
                        <div class="result-title">ì¼€ì´ìŠ¤ ë¶„ë¥˜</div>
                        <div class="result-value" id="category">-</div>
                        <div style="color: #666; font-size: 0.9em;" id="ruleApplied">-</div>
                    </div>

                    <div class="result-box">
                        <div class="result-title">ì¶”ì²œ ì‹œë‚˜ë¦¬ì˜¤</div>
                        <div class="result-value" id="recommendedScenario">-</div>
                    </div>

                    <div class="result-box">
                        <div class="result-title">ì˜ˆìƒ ì„¸ê¸ˆ</div>
                        <div class="result-value" id="expectedTax">-</div>
                    </div>

                    <div id="scenariosContainer"></div>

                    <div id="risksContainer"></div>

                    <div style="margin-top: 20px; padding: 15px; background: #e0e7ff; border-radius: 8px; font-size: 0.9em;">
                        <strong>ğŸ’¡ ì‹ ë¢°ë„:</strong> <span id="confidence">-</span>
                    </div>
                </div>

                <div id="placeholder" style="text-align: center; padding: 40px; color: #999;">
                    <p style="font-size: 3em;">ğŸ“‹</p>
                    <p>ì‚¬ì‹¤ê´€ê³„ë¥¼ ì…ë ¥í•˜ê³ <br>ì „ëµ ë¶„ì„ ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('taxForm').addEventListener('submit', function(e) {
            e.preventDefault();
            analyzeCase();
        });

        function analyzeCase() {
            // ì…ë ¥ ê°’ ê°€ì ¸ì˜¤ê¸°
            const acquisitionPrice = parseInt(document.getElementById('acquisitionPrice').value);
            const disposalPrice = parseInt(document.getElementById('disposalPrice').value);
            const houseCount = parseInt(document.getElementById('houseCount').value);
            const residenceYears = parseInt(document.getElementById('residenceYears').value);
            const adjustedArea = document.getElementById('adjustedArea').value === 'true';

            const acquisitionDate = new Date(document.getElementById('acquisitionDate').value);
            const disposalDate = new Date(document.getElementById('disposalDate').value);
            const holdingYears = (disposalDate - acquisitionDate) / (1000 * 60 * 60 * 24 * 365);

            const capitalGain = disposalPrice - acquisitionPrice;

            // ì¼€ì´ìŠ¤ ë¶„ë¥˜ ë¡œì§ (StrategyAgent ë¡œì§ ì‹œë®¬ë ˆì´ì…˜)
            let category, ruleApplied, expectedTax, recommended;

            if (houseCount === 1 && holdingYears >= 2 && residenceYears >= 2 && disposalPrice <= 1200000000) {
                category = '1ì£¼íƒ_ë¹„ê³¼ì„¸';
                ruleApplied = 'R020: 1ì£¼íƒ ë¹„ê³¼ì„¸ ìš”ê±´ ì¶©ì¡±';
                expectedTax = 0;
                recommended = 'ì§€ê¸ˆ_ì–‘ë„';
            } else if (houseCount === 1) {
                category = '1ì£¼íƒ_ê³¼ì„¸';
                ruleApplied = 'R030: 1ì£¼íƒ ë¹„ê³¼ì„¸ ìš”ê±´ ë¯¸ì¶©ì¡±';
                expectedTax = Math.floor(capitalGain * 0.35); // ê°„ë‹¨ ê³„ì‚°
                recommended = holdingYears < 2 ? '2ë…„_í›„_ì–‘ë„' : 'ì§€ê¸ˆ_ì–‘ë„';
            } else if (adjustedArea && houseCount >= 2) {
                category = 'ì¡°ì •ì§€ì—­_ì¤‘ê³¼';
                ruleApplied = 'R060: ì¡°ì •ëŒ€ìƒì§€ì—­ ë‹¤ì£¼íƒ ì¤‘ê³¼';
                expectedTax = Math.floor(capitalGain * 0.58); // ì¤‘ê³¼ì„¸ìœ¨
                recommended = '2ë…„_í›„_ì–‘ë„';
            } else if (houseCount >= 3) {
                category = 'ë‹¤ì£¼íƒ_ì¤‘ê³¼';
                ruleApplied = 'R050: ë‹¤ì£¼íƒ ì¤‘ê³¼ì„¸';
                expectedTax = Math.floor(capitalGain * 0.55);
                recommended = 'ë¹„ìš©_ìµœì í™”';
            } else {
                category = 'ë‹¤ì£¼íƒ_ì¼ë°˜';
                ruleApplied = 'R040: ë‹¤ì£¼íƒ ì¼ë°˜ ê³¼ì„¸';
                expectedTax = Math.floor(capitalGain * 0.45);
                recommended = 'ì§€ê¸ˆ_ì–‘ë„';
            }

            // ê²°ê³¼ í‘œì‹œ
            document.getElementById('placeholder').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');

            document.getElementById('category').textContent = category;
            document.getElementById('category').className = 'result-value ' + (expectedTax === 0 ? 'tax-free' : 'taxable');
            document.getElementById('ruleApplied').textContent = ruleApplied;

            document.getElementById('recommendedScenario').textContent = recommended;
            document.getElementById('expectedTax').textContent = formatNumber(expectedTax) + 'ì›';
            document.getElementById('expectedTax').className = 'result-value ' + (expectedTax === 0 ? 'tax-free' : 'taxable');

            // ì‹œë‚˜ë¦¬ì˜¤ ìƒì„±
            const scenarios = generateScenarios(category, expectedTax, capitalGain, holdingYears);
            displayScenarios(scenarios, recommended);

            // ë¦¬ìŠ¤í¬ ë¶„ì„
            const risks = analyzeRisks(category, capitalGain, holdingYears, residenceYears);
            displayRisks(risks);

            // ì‹ ë¢°ë„
            const confidence = calculateConfidence();
            document.getElementById('confidence').textContent = confidence + '%';
        }

        function generateScenarios(category, expectedTax, capitalGain, holdingYears) {
            const scenarios = [];

            // ì‹œë‚˜ë¦¬ì˜¤ 1: ì§€ê¸ˆ ì–‘ë„
            scenarios.push({
                name: 'ì§€ê¸ˆ_ì–‘ë„',
                tax: expectedTax,
                totalCost: expectedTax + 10000000,
                pros: category.includes('ë¹„ê³¼ì„¸') ? ['ë¹„ê³¼ì„¸ ì ìš©', 'ì¦‰ì‹œ í˜„ê¸ˆí™”'] : ['ì¦‰ì‹œ í˜„ê¸ˆí™”', 'ì‹œì¥ ë¶ˆí™•ì‹¤ì„± íšŒí”¼'],
                cons: ['í–¥í›„ ì‹œì„¸ ìƒìŠ¹ ê¸°íšŒ ìƒì‹¤', 'ì¬ì·¨ë“ ì‹œ ì·¨ë“ì„¸ ë¶€ë‹´']
            });

            // ì‹œë‚˜ë¦¬ì˜¤ 2: ë‚˜ì¤‘ì— ì–‘ë„ (ì¡°ê±´ë¶€)
            if (holdingYears < 2 || !category.includes('ë¹„ê³¼ì„¸')) {
                const laterTax = Math.floor(expectedTax * 0.85); // ì„¸ê¸ˆ ê°ì†Œ ì‹œë®¬ë ˆì´ì…˜
                scenarios.push({
                    name: holdingYears < 2 ? '2ë…„_í›„_ì–‘ë„' : '1ë…„_í›„_ì–‘ë„',
                    tax: laterTax,
                    totalCost: laterTax + 22000000,
                    pros: ['ì¥ê¸°ë³´ìœ ê³µì œ ì ìš©', 'ì„¸ìœ¨ ê°ì†Œ'],
                    cons: ['ë³´ìœ  ë¹„ìš© ë°œìƒ', 'ì‹œì„¸ í•˜ë½ ìœ„í—˜']
                });
            }

            return scenarios;
        }

        function displayScenarios(scenarios, recommended) {
            const container = document.getElementById('scenariosContainer');
            container.innerHTML = '<h3 style="margin: 20px 0 15px 0; color: #667eea;">ğŸ’¡ ì‹œë‚˜ë¦¬ì˜¤</h3>';

            scenarios.forEach(scenario => {
                const isRecommended = scenario.name === recommended;
                const netBenefit = scenario.totalCost;

                const html = `
                    <div class="scenario">
                        <h4>
                            ${isRecommended ? '<span class="badge recommended">âœ… ì¶”ì²œ</span>' : ''}
                            ${scenario.name}
                        </h4>
                        <p><strong>ì˜ˆìƒ ì„¸ê¸ˆ:</strong> ${formatNumber(scenario.tax)}ì›</p>
                        <p><strong>ì´ ë¹„ìš©:</strong> ${formatNumber(scenario.totalCost)}ì›</p>
                        <div class="pros-cons">
                            <div class="pros">
                                <strong>ğŸ‘ ì¥ì :</strong>
                                <ul>${scenario.pros.map(p => '<li>' + p + '</li>').join('')}</ul>
                            </div>
                            <div class="cons">
                                <strong>ğŸ‘ ë‹¨ì :</strong>
                                <ul>${scenario.cons.map(c => '<li>' + c + '</li>').join('')}</ul>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function analyzeRisks(category, capitalGain, holdingYears, residenceYears) {
            const risks = [];

            if (capitalGain > 100000000) {
                risks.push({
                    title: 'ê³ ì•¡ ì„¸ê¸ˆ ë¶€ë‹´',
                    description: 'ì˜ˆìƒ ì„¸ê¸ˆì´ ë†’ìŠµë‹ˆë‹¤. ê³„ì‚° ê·¼ê±° ìë£Œë¥¼ ì² ì €íˆ ì¤€ë¹„í•˜ì„¸ìš”.'
                });
            }

            if (holdingYears < 2) {
                risks.push({
                    title: 'ë³´ìœ ê¸°ê°„ ë¶€ì¡±',
                    description: '2ë…„ ë¯¸ë§Œ ë³´ìœ ë¡œ ì¥ê¸°ë³´ìœ ê³µì œê°€ ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'
                });
            }

            if (category.includes('ì¤‘ê³¼')) {
                risks.push({
                    title: 'ì¤‘ê³¼ì„¸ìœ¨ ì ìš©',
                    description: 'ë‹¤ì£¼íƒì ë˜ëŠ” ì¡°ì •ì§€ì—­ ì¤‘ê³¼ì„¸ìœ¨ì´ ì ìš©ë©ë‹ˆë‹¤.'
                });
            }

            if (category.includes('ë¹„ê³¼ì„¸') && residenceYears < 2) {
                risks.push({
                    title: 'ë¹„ê³¼ì„¸ ìš”ê±´ ë¯¸ì¶©ì¡±',
                    description: 'ê±°ì£¼ ê¸°ê°„ì´ 2ë…„ ë¯¸ë§Œì…ë‹ˆë‹¤.'
                });
            }

            return risks;
        }

        function displayRisks(risks) {
            const container = document.getElementById('risksContainer');

            if (risks.length === 0) {
                container.innerHTML = '';
                return;
            }

            container.innerHTML = '<h3 style="margin: 20px 0 15px 0; color: #667eea;">âš ï¸ ë¦¬ìŠ¤í¬</h3>';

            risks.forEach(risk => {
                container.innerHTML += `
                    <div class="risk-item">
                        <strong>${risk.title}</strong>
                        <p style="margin-top: 5px; font-size: 0.9em;">${risk.description}</p>
                    </div>
                `;
            });
        }

        function calculateConfidence() {
            // ëª¨ë“  í•„ìˆ˜ ì •ë³´ê°€ ì…ë ¥ë˜ì—ˆìœ¼ë¯€ë¡œ 95%
            return 95;
        }

        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
    </script>
</body>
</html>
